#     |u11|
# U = |u21|
#     |u12|
#     |u22|
#
# U = AU + B

A = [
    [0.00, 0.25, 0.25, 0.00],
    [0.25, 0.00, 0.00, 0.25],
    [0.25, 0.00, 0.00, 0.25],
    [0.00, 0.25, 0.25, 0.00],
]

B = [
    50.,
    50.,
    25.,
    25.,
]

# Initial values
u11, u21, u12, u22 = 0., 0., 0., 0.
print(f'U = [{u11} {u21} {u12} {u22}]')

for _ in range(20):
    v11 = A[0][0]*u11 + A[0][1]*u21 + A[0][2]*u12 + A[0][3]*u22 + B[0]
    v21 = A[1][0]*v11 + A[1][1]*u21 + A[1][2]*u12 + A[1][3]*u22 + B[1]
    v12 = A[2][0]*v11 + A[2][1]*v21 + A[2][2]*u12 + A[2][3]*u22 + B[2]
    v22 = A[3][0]*v11 + A[3][1]*v21 + A[3][2]*v12 + A[3][3]*u22 + B[3]
    u11, u21, u12, u22 = v11, v21, v12, v22
    print(f'U = [{u11} {u21} {u12} {u22}]')
